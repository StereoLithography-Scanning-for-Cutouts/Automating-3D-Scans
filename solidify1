import bpy

# Specify the file path
file_path = r'C:\Users\Yerdana\Downloads\poly.glb'

# Import glTF 2.0 file
bpy.ops.import_scene.gltf(filepath=file_path)

# Get the active object
obj = bpy.context.active_object

if obj and obj.type == 'MESH':
    # Duplicate the mesh
    bpy.ops.object.duplicate(linked=False)
    inner_obj = bpy.context.active_object
    
    # Scale the inner object slightly
    inner_obj.scale = (0.99, 0.99, 0.99)
    
    # Join the two objects
    bpy.context.view_layer.objects.active = obj
    bpy.ops.object.select_all(action='DESELECT')
    obj.select_set(True)
    inner_obj.select_set(True)
    bpy.context.view_layer.objects.active = obj
    bpy.ops.object.join()
    
    # Add Solidify modifier to the joined object
    bpy.ops.object.modifier_add(type='SOLIDIFY')
    solidify_modifier = obj.modifiers["Solidify"]
    solidify_modifier.thickness = 0.00318  # Adjust thickness as needed (0.00157 for 1/8 inch thickness lead)
    solidify_modifier.offset = 1.0
    solidify_modifier.use_even_offset = False
    solidify_modifier.use_rim = False
    bpy.ops.object.modifier_apply({"object": obj}, modifier="Solidify")
    print("Solidify modifier applied.")
else:
    print("No active mesh object found.")
